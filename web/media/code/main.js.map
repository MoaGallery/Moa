{"version":3,"file":"main.js","mappings":"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","sources":["./src/app/app.component.ts","./src/app/app.component.html","./src/app/app.module.ts","./src/app/app.service.ts","./src/app/breadcrumb/breadcrumb.component.html","./src/app/breadcrumb/breadcrumb.component.ts","./src/app/gallery/gallery-edit/gallery-edit.component.html","./src/app/gallery/gallery-edit/gallery-edit.component.ts","./src/app/gallery/gallery-info/gallery-info.component.ts","./src/app/gallery/gallery-info/gallery-info.component.html","./src/app/gallery/gallery-list/gallery-list.component.ts","./src/app/gallery/gallery-list/gallery-list.component.html","./src/app/gallery/gallery-tile/gallery-tile.component.html","./src/app/gallery/gallery-tile/gallery-tile.component.ts","./src/app/gallery/gallery-toolbar/gallery-toolbar.component.ts","./src/app/gallery/gallery-toolbar/gallery-toolbar.component.html","./src/app/gallery/gallery.module.ts","./src/app/gallery/gallery.service.ts","./src/app/gallery/state/gallery.action.ts","./src/app/gallery/state/gallery.effect.ts","./src/app/gallery/state/gallery.reducer.ts","./src/app/gallery/state/gallery.selector.ts","./src/app/home/home-toolbar/home-toolbar.component.ts","./src/app/home/home-toolbar/home-toolbar.component.html","./src/app/image/image-add/image-add.component.html","./src/app/image/image-add/image-add.component.ts","./src/app/image/image-edit/image-edit.component.html","./src/app/image/image-edit/image-edit.component.ts","./src/app/image/image-info/image-info.component.ts","./src/app/image/image-info/image-info.component.html","./src/app/image/image-list/image-list.component.html","./src/app/image/image-list/image-list.component.ts","./src/app/image/image-thumb/image-thumb.component.html","./src/app/image/image-thumb/image-thumb.component.ts","./src/app/image/image-toolbar/image-toolbar.component.ts","./src/app/image/image-toolbar/image-toolbar.component.html","./src/app/image/image.service.ts","./src/app/ngbox/ngbox.component.ts","./src/app/ngbox/ngbox.directive.ts","./src/app/ngbox/ngbox.service.ts","./src/app/pages/gallery-page/gallery-page.component.ts","./src/app/pages/gallery-page/gallery-page.component.html","./src/app/pages/home-page/home-page.component.ts","./src/app/pages/home-page/home-page.component.html","./src/app/pages/image-page/image-page.component.ts","./src/app/pages/image-page/image-page.component.html","./src/app/reducers/index.ts","./src/app/services/button-click.service.ts","./src/app/services/data.service.ts","./src/app/services/page_data.service.ts","./src/app/services/page_title.service.ts","./src/app/services/simple_gallery-entity.service.ts","./src/app/services/simple_gallery.data.service.ts","./src/app/services/thumbnail.service.ts","./src/app/state/app.action.ts","./src/app/state/app.effect.ts","./src/app/state/app.reducer.ts","./src/app/state/app.selector.ts","./src/environments/environment.ts","./src/main.ts"],"sourcesContent":["import {Component, ElementRef, OnInit} from '@angular/core';\nimport {DataService} from \"./services/data.service\";\nimport {Router} from \"@angular/router\";\nimport {PageTitleService} from \"./services/page_title.service\";\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent implements OnInit {\n    preload = {};\n    data = [];\n\n    constructor(private router: Router,\n                private service: DataService,\n                private pageTitleService: PageTitleService,\n                private elementRef:ElementRef) {\n        this.preload = JSON.parse(this.elementRef.nativeElement.getAttribute('[preload]'));\n    }\n\n    ngOnInit(): void {\n        this.service.setPageData(this.preload);\n    }\n}\n","<breadcrumb></breadcrumb>\n\n<router-outlet></router-outlet>","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\n\n\nimport { AppComponent } from './app.component';\nimport { BreadcrumbComponent } from './breadcrumb/breadcrumb.component';\nimport { GalleryListComponent } from './gallery/gallery-list/gallery-list.component';\nimport { GalleryTileComponent } from './gallery/gallery-tile/gallery-tile.component';\nimport { DataService } from \"./services/data.service\";\nimport { PageTitleService } from \"./services/page_title.service\";\nimport { PageDataService } from \"./services/page_data.service\";\nimport { HttpClientModule } from \"@angular/common/http\";\nimport { RouterModule, Routes } from \"@angular/router\";\nimport { GalleryPageComponent } from './pages/gallery-page/gallery-page.component';\nimport { HomePageComponent } from './pages/home-page/home-page.component';\nimport { GalleryInfoComponent } from './gallery/gallery-info/gallery-info.component';\nimport { ImageListComponent } from './image/image-list/image-list.component';\nimport { ImageThumbComponent } from './image/image-thumb/image-thumb.component';\nimport { GalleryToolbarComponent } from './gallery/gallery-toolbar/gallery-toolbar.component';\nimport { GalleryEditComponent } from './gallery/gallery-edit/gallery-edit.component';\nimport { ButtonClickService } from \"./services/button-click.service\";\nimport { FormsModule } from \"@angular/forms\";\nimport { GalleryService } from \"./gallery/gallery.service\";\nimport { ImageService } from \"./image/image.service\";\nimport { ImagePageComponent } from './pages/image-page/image-page.component';\nimport { ImageInfoComponent } from './image/image-info/image-info.component';\nimport { ImageToolbarComponent } from './image/image-toolbar/image-toolbar.component';\nimport { ImageEditComponent } from './image/image-edit/image-edit.component';\nimport { ThumbnailService } from \"./services/thumbnail.service\";\nimport { ImageAddComponent } from \"./image/image-add/image-add.component\";\nimport { FileUploadModule } from 'primeng/fileupload';\nimport { HomeToolbarComponent } from \"./home/home-toolbar/home-toolbar.component\";\nimport { NgBoxService } from \"./ngbox/ngbox.service\";\nimport { NgBoxComponent } from \"./ngbox/ngbox.component\";\nimport { NgBoxDirective } from \"./ngbox/ngbox.directive\";\nimport {EntityDataModule, EntityDataService, EntityDefinitionService, EntityDispatcherDefaultOptions, EntityMetadataMap} from '@ngrx/data';\nimport {StoreModule} from '@ngrx/store';\nimport {EffectsModule} from '@ngrx/effects';\nimport {StoreDevtoolsModule} from '@ngrx/store-devtools';\nimport {environment} from '../environments/environment';\nimport {metaReducers, reducers} from './reducers';\nimport {RouterState, StoreRouterConnectingModule} from '@ngrx/router-store';\nimport {SimpleGalleryDataService} from './services/simple_gallery.data.service';\nimport {SimpleGalleryEntityService} from './services/simple_gallery-entity.service';\nimport {GalleryModule} from './gallery/gallery.module';\nimport {AppEffect} from './state/app.effect';\nimport {AppService} from './app.service';\n\nconst routes: Routes = [\n\t{\n\t\tpath: '',\n\t\tcomponent: HomePageComponent\n\t},\n\t{\n\t\tpath: 'gallery/:gallery_id',\n\t\tcomponent: GalleryPageComponent,\n\t\tresolve: {\n\t\t\t//gallery: GalleryResolver\n\t\t}\n\t},\n\t{\n\t\tpath: 'image/:gallery_id/:image_id',\n\t\tcomponent: ImagePageComponent\n\t}\n];\n\nconst entityMetadata: EntityMetadataMap = {\n\tGallery: {\n\t\tentityDispatcherOptions: {\n\t\t\toptimisticUpdate: true\n\t\t}\n\t},\n\tSimpleGallery: {}\n};\n\n@NgModule({\n\tdeclarations: [\n\t\tAppComponent,\n\t\tBreadcrumbComponent,\n\n\t\tGalleryListComponent,\n\t\tGalleryTileComponent,\n\t\tGalleryInfoComponent,\n\t\tGalleryToolbarComponent,\n\t\tGalleryEditComponent,\n\n\t\tImageListComponent,\n\t\tImageThumbComponent,\n\t\tImageInfoComponent,\n\n\t\tHomeToolbarComponent,\n\n\t\t// Route pages\n\t\tHomePageComponent,\n\t\tGalleryPageComponent,\n\t\tImagePageComponent,\n\t\tImageToolbarComponent,\n\t\tImageEditComponent,\n\t\tImageAddComponent,\n\n\t\tNgBoxComponent,\n\t\tNgBoxDirective\n\t],\n\timports: [\n\t\tBrowserModule,\n\t\tHttpClientModule,\n\t\tRouterModule.forRoot(routes, {}),\n\t\tFormsModule,\n\t\tFileUploadModule,\n\t\tStoreModule.forRoot(reducers, {\n\t\t\tmetaReducers,\n\t\t\truntimeChecks : {\n\t\t\t\tstrictStateImmutability: true,\n\t\t\t\tstrictActionImmutability: true,\n\t\t\t\tstrictActionSerializability: true,\n\t\t\t\tstrictStateSerializability:true\n\t\t\t}\n\t\t}),\n\t\tGalleryModule,\n\t\tStoreDevtoolsModule.instrument({maxAge: 25, logOnly: environment.production}),\n\t\tEffectsModule.forRoot([AppEffect]),\n\t\tEntityDataModule.forRoot({}),\n\t\tStoreRouterConnectingModule.forRoot({\n\t\t\tstateKey: 'router',\n\t\t\trouterState: RouterState.Minimal\n\t\t})\n\t],\n\tproviders: [\n\t\tDataService,\n\t\tPageTitleService,\n\t\tPageDataService,\n\t\tButtonClickService,\n\t\tGalleryService,\n\t\tImageService,\n\t\tAppService,\n\t\tThumbnailService,\n\t\tNgBoxService,\n\t\tSimpleGalleryDataService,\n\t\tSimpleGalleryEntityService\n\t],\n\tbootstrap: [\n\t\tAppComponent\n\t]\n})\nexport class AppModule {\n\tconstructor(\n\t\tprivate eds: EntityDefinitionService,\n\t\tprivate entityDataService: EntityDataService,\n\t\tprivate simpleGalleryDataService: SimpleGalleryDataService\n\t) {\n\t\teds.registerMetadataMap(entityMetadata);\n\t\tentityDataService.registerService('SimpleGallery', this.simpleGalleryDataService);\n\t}\n}\n","import {Injectable} from \"@angular/core\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {throwError, Observable} from \"rxjs\";\nimport {catchError, tap} from 'rxjs/operators';\n\n@Injectable()\nexport class AppService {\n\tprotected api_url: string = '/api/other/';\n\n\tconstructor(private http: HttpClient) {\n\t}\n\n\tprivate handleError(err: any) {\n\t\t// in a real world app, we may send the server to some remote logging infrastructure\n\t\t// instead of just logging it to the console\n\t\tlet errorMessage: string;\n\t\tif (err.error instanceof ErrorEvent) {\n\t\t\t// A client-side or network error occurred. Handle it accordingly.\n\t\t\terrorMessage = `An error occurred: ${err.error.message}`;\n\t\t} else {\n\t\t\t// The backend returned an unsuccessful response code.\n\t\t\t// The response body may contain clues as to what went wrong,\n\t\t\terrorMessage = `Backend returned code ${err.status}: ${err.body.error}`;\n\t\t}\n\t\tconsole.error(err);\n\t\treturn throwError(errorMessage);\n\t}\n\tgetOtherData(): Observable<{galleries: [], tags: []}> {\n\t\treturn this.http.get<{galleries: [], tags: []}>(this.api_url)\n\t\t\t.pipe(\n\t\t\t\t/*tap(data => console.log(JSON.stringify(data))),*/\n\t\t\t\tcatchError(this.handleError)\n\t\t\t);\n\t}\n}\n","<ol class=\"breadcrumb\">\n\t<li><a [routerLink]=\"['/']\">Home</a></li>\n\n\t<li *ngFor=\"let crumb of crumbs; let last = last\">\n\t  <a *ngIf=\"!last\"  [routerLink]=\"[getLink(crumb.id)]\">{{crumb.name}}</a>\n\t  <span *ngIf=\"last\">{{crumb.name}}</span>\n\t</li>\n</ol>\n","import {Component, OnDestroy} from '@angular/core';\nimport {Breadcrumb} from \"../models/breadcrumb.model\";\nimport {DataService} from \"../services/data.service\";\nimport {Subscription} from \"rxjs/Subscription\";\n\n@Component({\n  selector: 'breadcrumb',\n  templateUrl: './breadcrumb.component.html',\n  styleUrls: ['./breadcrumb.component.css']\n})\nexport class BreadcrumbComponent implements OnDestroy {\n    crumbs: Breadcrumb[];\n    observer: Subscription;\n\n    constructor(private service: DataService){\n        this.observer = service.getBreadcrumbObserver().subscribe(\n            data => {\n                this.crumbs = data;\n            }\n        );\n    }\n\n    ngOnDestroy(): void {\n        this.observer.unsubscribe();\n    }\n\n    getLink(id) {\n        for (let i = 0; i < this.crumbs.length; i++) {\n            if (this.crumbs[i].id == id) {\n                return '/' + this.crumbs[i].type + '/' + this.crumbs[i].id;\n            }\n        }\n\n        return '/';\n    }\n}\n","<div class=\"modal fade\" id=\"edit-modal\">\n\t<div class=\"modal-dialog\">\n\t\t<div class=\"modal-content\">\n\t\t\t<div class=\"modal-header\">\n\t\t\t\t<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n\t\t\t\t<h4 class=\"modal-title\">Edit gallery</h4>\n\t\t\t</div>\n\t\t\t<form action=\"/gallery/{{gallery.id}}\" method=\"post\" class=\"form-horizontal\">\n\t\t\t\t<div class=\"modal-body\">\n\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<label for=\"inputGalleryName\" class=\"col-sm-2 control-label\">Name</label>\n\t\t\t\t\t\t<div class=\"col-sm-10\">\n\t\t\t\t\t\t\t<input type=\"text\" class=\"form-control\" name=\"inputGalleryName\" id=\"inputGalleryName\" placeholder=\"Edit...\" [(ngModel)]=\"name\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<label for=\"inputGalleryDescription\" class=\"col-sm-2 control-label\">Description</label>\n\t\t\t\t\t\t<div class=\"col-sm-10\">\n\t\t\t\t\t\t\t<textarea class=\"form-control\" name=\"inputGalleryDescription\" id=\"inputGalleryDescription\" placeholder=\"Edit...\" [(ngModel)]=\"description\"></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<label for=\"inputGalleryParent\" class=\"col-sm-2 control-label\">Parent</label>\n\t\t\t\t\t\t<div class=\"col-sm-10\">\n\t\t\t\t\t\t\t<select class=\"form-control\" name=\"inputGalleryParent\" id=\"inputGalleryParent\" style=\"width: 100%\" *ngIf=\"gallery.parentGallery !== undefined\">\n\t\t\t\t\t\t\t\t<option value=\"{{gallery.parentGallery.id}}\" selected=\"selected\">{{gallery.parentGallery.name}}</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<label for=\"inputGalleryTags\" class=\"col-sm-2 control-label\">Tags</label>\n\t\t\t\t\t\t<div class=\"col-sm-10\">\n\t\t\t\t\t\t\t<select class=\"form-control\" name=\"inputGalleryTags[]\" id=\"inputGalleryTags\" style=\"width: 100%\" multiple>\n\t\t\t\t\t\t\t\t<option *ngFor=\"let tag of tagList\" value=\"{{tag.id}}\" selected=\"selected\">{{tag.name}}</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<div class=\"checkbox\">\n\t\t\t\t\t\t\t<div class=\"col-sm-2\"></div>\n\t\t\t\t\t\t\t<div class=\"col-sm-10\">\n\t\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"inputGalleryCombinedView\" id=\"inputGalleryCombinedView\" [(ngModel)]=\"showImages\">\n\t\t\t\t\t\t\t\t<label for=\"inputGalleryCombinedView\" class=\"control-label\">Show images when there are subgalleries</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<div class=\"checkbox\">\n\t\t\t\t\t\t\t<div class=\"col-sm-2\"></div>\n\t\t\t\t\t\t\t<div class=\"col-sm-10\">\n\t\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"inputGalleryUseTags\" id=\"inputGalleryUseTags\" [(ngModel)]=\"useTags\">\n\t\t\t\t\t\t\t\t<label for=\"inputGalleryUseTags\" class=\"control-label\">Populate from tags</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"modal-footer\">\n\t\t\t\t\t<button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>\n\t\t\t\t\t<input (click)=\"onSubmit()\" type=\"submit\" class=\"btn btn-primary\" value=\"Save changes\">\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div><!-- /.modal-content -->\n\t</div><!-- /.modal-dialog -->\n</div><!-- /.modal -->\n","import {Component, Input, OnDestroy} from '@angular/core';\nimport {ButtonClickService} from \"../../services/button-click.service\";\nimport {Subscription} from \"rxjs/Subscription\";\nimport {GalleryService} from \"../gallery.service\";\nimport {Router} from \"@angular/router\";\nimport {GalleryModel} from '../gallery.model';\n\ndeclare var $: any;\n\n@Component({\n  selector: 'gallery-edit',\n  templateUrl: './gallery-edit.component.html',\n  styleUrls: ['./gallery-edit.component.css']\n})\nexport class GalleryEditComponent implements OnDestroy {\n\n\tprivate subscription: Subscription;\n\n\t@Input() gallery: GalleryModel;\n\taddMode: boolean = false;\n\n\ttagList = [];\n\tname: String = '';\n\tdescription: String = '';\n\tuseTags: boolean = false;\n\tshowImages: boolean = false;\n\n\tconstructor(private buttonClickService: ButtonClickService,\n\t            private galleryService: GalleryService,\n\t            private router: Router) {\n\t\tthis.subscription = this.buttonClickService.notifyObservable$.subscribe(\n\t\t\tdata => {\n\t\t\t\tif ((data.name !== 'galleryEditClick') &&\n\t\t\t\t\t(data.name !== 'galleryAddClick'))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.addMode = data.name === 'galleryAddClick';\n\n\t\t\t\tthis.reset();\n\t\t\t\t$('#edit-modal').modal('show');\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t$('#inputGalleryParent').select2({\n\t\t\t\t\t\tajax: {\n\t\t\t\t\t\t\turl: '/api/gallery_lookup',\n\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\tdata: function (params) {\n\t\t\t\t\t\t\t\treturn  {\n\t\t\t\t\t\t\t\t\tq: params.term,\n\t\t\t\t\t\t\t\t\tpage: params.page || 1\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t$('#inputGalleryTags').select2({\n\t\t\t\t\t\ttags: true,\n\t\t\t\t\t\tajax: {\n\t\t\t\t\t\t\turl: '/api/tag_lookup',\n\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\tdata: function (params) {\n\t\t\t\t\t\t\t\treturn  {\n\t\t\t\t\t\t\t\t\tq: params.term,\n\t\t\t\t\t\t\t\t\tpage: params.page || 1\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t)\n\t}\n\n\treset() {\n\t\tif (!this.addMode) {\n\t\t\tthis.name = this.gallery.name;\n\t\t\tthis.description = this.gallery.description;\n\t\t\tthis.useTags = this.gallery.useTags;\n\t\t\tthis.showImages = this.gallery.combinedView;\n\t\t} else\n\t\t{\n\t\t\tthis.name = '';\n\t\t\tthis.description = '';\n\t\t\tthis.useTags = true;\n\t\t\tthis.showImages = false;\n\t\t}\n\t\tthis.tagList = [];\n\n\t\tfor (let tag of this.gallery.tagList) {\n\t\t\tthis.tagList.push({name: tag.name, id: ''+tag.id});\n\t\t}\n\t}\n\n\tonSubmit() {\n\t\t// Select2 isn't synchronising so we have to get the selections manually\n\t\tlet tagData = $('#inputGalleryTags').select2('data');\n\t\tlet tags = [];\n\t\tfor (let tag of tagData)\n\t\t{\n\t\t\ttags.push(tag.id);\n\t\t}\n\n\t\tlet galleryData = $('#inputGalleryParent').select2('data');\n\t\tthis.gallery.parentGallery.id = galleryData[0].id;\n\n\t\tlet id = 0;\n\t\tif (!this.addMode)\n\t\t\tid = this.gallery.id;\n\n\t\t/*this.galleryService.SubmitGallery({\n\t\t\tid: id,\n\t\t\tname: this.name,\n\t\t\tdescription: this.description,\n\t\t\tparent: this.gallery.parentGallery.id,\n\t\t\ttags: tags,\n\t\t\tuseTags: this.useTags,\n\t\t\tshowImages: this.showImages\n\t\t}).subscribe(data => {\n\t\t\tlet options =\n\t\t\t{\n\t\t\t\tmessage: 'Gallery saved',\n\t\t\t\tcontainer: '#editSuccessContainer',\n\t\t\t\tduration: 5000\n\t\t\t};\n\t\t\t$.meow(options);\n\t\t\t$('#inputGalleryTags').children().remove();\n\t\t\t$('#edit-modal').modal('hide');\n\n\t\t\tif (this.addMode) {\n\t\t\t\tthis.router.navigate(['/gallery/' + data.message])\n\t\t\t}\n\t\t});*/\n\t}\n\n\tngOnDestroy(): void {\n\t\tthis.subscription.unsubscribe();\n\t}\n}\n","import {Component} from '@angular/core';\nimport {Store} from '@ngrx/store';\nimport {GalleryInfoData, getGalleryInfo} from '../state/gallery.selector';\nimport {GalleryState} from '../state/gallery.reducer';\n\n@Component({\n  selector: 'gallery-info',\n  templateUrl: './gallery-info.component.html',\n  styleUrls: ['./gallery-info.component.css']\n})\nexport class GalleryInfoComponent {\n\n\tpublic galleryData;\n\n\tconstructor(private store: Store<GalleryState>) {\n\t}\n\n\tprivate ngOnInit() {\n\t\tthis.store.select(getGalleryInfo).subscribe(\n\t\t\t(data: GalleryInfoData) => {\n\t\t\t\tthis.galleryData = data;\n\t\t\t}\n\t\t);\n\t}\n}\n","<div *ngIf=\"galleryData\">\n\t<h1>{{galleryData.name}}</h1>\n\t<p>\n\t\t{{galleryData.description}}\n\t</p>\n</div>\n","import {Component} from '@angular/core';\nimport {Store} from '@ngrx/store';\nimport {GalleryState} from '../state/gallery.reducer';\nimport {getGalleryId} from '../state/gallery.selector';\nimport {AppState} from '../../state/app.reducer';\nimport {SimpleGallery} from '../../models/simple_gallery';\nimport {getSubGalleries} from '../../state/app.selector';\n\n@Component({\n  selector: 'gallery-list',\n  templateUrl: './gallery-list.component.html',\n  styleUrls: ['./gallery-list.component.css']\n})\nexport class GalleryListComponent {\n\n\tpublic galleryId: number = 0;\n\tpublic galleries: SimpleGallery[] = [];\n\n    constructor(private galleryStore: Store<GalleryState>,\n                private appStore: Store<AppState>) {\n    }\n\n\tngOnInit(): void {\n\t\tthis.galleryStore.select(getGalleryId).subscribe(\n\t\t\t(id: number) => {\n\t\t\t\tthis.galleryId = id;\n\n\t\t\t\tthis.appStore.select(getSubGalleries({id: this.galleryId})).subscribe(\n\t\t\t\t\t(galleries: SimpleGallery[]) => {\n\t\t\t\t\t\tthis.galleries = galleries;\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\t}\n}\n","<div class=\"row\">\n\t<ul class=\"list-unstyled\">\n\t\t<li *ngFor=\"let gallery of galleries\" class=\"thumbnail col-md-3\" style=\"min-height: 150px;\">\n\t\t\t<gallery-tile [gallery]=\"gallery\"></gallery-tile>\n\t\t</li>\n\t</ul>\n</div>","<a [routerLink]=\"[getLink(gallery.id)]\">\n\t<img *ngIf=\"!doesThumbExist(gallery.thumbId)\" src=\"http://placehold.it/300x200\">\n\t<img *ngIf=\"doesThumbExist(gallery.thumbId)\" src=\"/image/thumb/{{gallery.thumbId}}.jpg\">\n\t<h4>{{gallery.name}}</h4>\n</a>\n","import { Component, Input } from '@angular/core';\nimport {SimpleGallery} from '../../models/simple_gallery';\n\n@Component({\n  selector: 'gallery-tile',\n  templateUrl: './gallery-tile.component.html',\n  styleUrls: ['./gallery-tile.component.css']\n})\nexport class GalleryTileComponent {\n\n    @Input() gallery: SimpleGallery;\n\n    constructor() { }\n    getLink(id) {\n        return '/gallery/' + this.gallery.id;\n    }\n\n\tdoesThumbExist(thumbId: number) {\n    \treturn thumbId !== null;\n\t}\n}\n","import {Component, Input} from '@angular/core';\nimport {GalleryService} from \"../gallery.service\";\nimport {Router} from \"@angular/router\";\nimport {Gallery} from '../../models/gallery';\nimport {map, tap} from 'rxjs/operators';\nimport {Observable} from 'rxjs';\n\ndeclare var $: any;\n\n@Component({\n  selector: 'gallery-toolbar',\n  templateUrl: './gallery-toolbar.component.html',\n  styleUrls: ['./gallery-toolbar.component.css']\n})\nexport class GalleryToolbarComponent {\n\n\t@Input() gallery: Gallery;\n\n\tconstructor(private router: Router) {\n\t}\n\n\tprivate ngOnInit() {\n\t}\n\n\tonEditClick() {\n\t\t//this.buttonClickService.trigger('galleryEditClick');\n\t}\n\n\tonAddGalleryClick() {\n\t\t//this.buttonClickService.trigger('galleryAddClick');\n\t}\n\n\tonAddImageClick() {\n\t\t//this.buttonClickService.trigger('imageAddClick');\n\t}\n\n\tonDeleteClick() {\n\t\tif (confirm('Delete this gallery?')) {\n\t\t\t/*this.galleryService.delete(this.gallery)\n\t\t\t\t.pipe(\n\t\t\t\t\ttap(gallery => {\n\t\t\t\t\t\tlet options =\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmessage: 'Gallery deleted',\n\t\t\t\t\t\t\t\tcontainer: '#editSuccessContainer',\n\t\t\t\t\t\t\t\tduration: 5000\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t$.meow(options);\n\n\t\t\t\t\t\tif (this.gallery.parentId > 0)\n\t\t\t\t\t\t\tthis.router.navigate(['/gallery/' + this.gallery.parentId]);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthis.router.navigate(['/']);\n\t\t\t\t\t})\n\t\t\t\t);*/\n\t\t}\n\t}\n}\n","<gallery-edit [gallery]=\"gallery\"></gallery-edit>\n<image-add [gallery]=\"gallery\"></image-add>\n\n<div class=\"row\">\n\t<div class=\"pull-right\">\n\t\t<div class=\"btn-group\" role=\"group\" aria-label=\"...\">\n\t\t\t<button type=\"button\" (click)=\"onAddGalleryClick()\" class=\"btn btn-default\" id=\"galleryAdd\" title=\"Add gallery\" data-toggle=\"tooltip\"><span class=\"glyphicon glyphicon-th\"></span></button>\n\t\t\t<button type=\"button\" (click)=\"onAddImageClick()\" class=\"btn btn-default\" id=\"imageAdd\" title=\"Add image\" data-toggle=\"tooltip\"><span class=\"glyphicon glyphicon-picture\"></span></button>\n\t\t\t<button type=\"button\" (click)=\"onEditClick()\" class=\"btn btn-default\" id=\"galleryEdit\" title=\"Edit gallery\" data-toggle=\"tooltip\"><span class=\"glyphicon glyphicon-pencil\"></span></button>\n\t\t\t<button type=\"button\" (click)=\"onDeleteClick()\" class=\"btn btn-default\" id=\"galleryDelete\" title=\"Delete gallery\" data-toggle=\"tooltip\"><span class=\"glyphicon glyphicon-trash\"></span></button>\n\t\t</div>\n\t</div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport {StoreModule} from '@ngrx/store';\nimport {galleryReducer} from './state/gallery.reducer';\nimport {EffectsModule} from '@ngrx/effects';\nimport {GalleryEffect} from './state/gallery.effect';\n\n\n@NgModule({\n  declarations: [],\n  imports: [\n    CommonModule,\n\tStoreModule.forFeature('gallery', galleryReducer),\n\tEffectsModule.forFeature([GalleryEffect])\n  ]\n})\nexport class GalleryModule { }\n","import {Injectable} from \"@angular/core\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {throwError, Observable} from \"rxjs\";\nimport {catchError, tap} from 'rxjs/operators';\nimport {Gallery, GalleryModel} from './gallery.model';\n\n@Injectable()\nexport class GalleryService {\n\tget gallery(): GalleryModel {\n\t\treturn this._gallery;\n\t}\n\n\tprotected api_url: string = '/api/gallery/';\n\tprivate _gallery: GalleryModel;\n\n\tconstructor(private http: HttpClient) {\n\t}\n\n\tprivate handleError(err: any) {\n\t\t// in a real world app, we may send the server to some remote logging infrastructure\n\t\t// instead of just logging it to the console\n\t\tlet errorMessage: string;\n\t\tif (err.error instanceof ErrorEvent) {\n\t\t\t// A client-side or network error occurred. Handle it accordingly.\n\t\t\terrorMessage = `An error occurred: ${err.error.message}`;\n\t\t} else {\n\t\t\t// The backend returned an unsuccessful response code.\n\t\t\t// The response body may contain clues as to what went wrong,\n\t\t\terrorMessage = `Backend returned code ${err.status}: ${err.body.error}`;\n\t\t}\n\t\tconsole.error(err);\n\t\treturn throwError(errorMessage);\n\t}\n\tgetGallery(id: number): Observable<Gallery> {\n\t\treturn this.http.get<Gallery>(this.api_url + id)\n\t\t\t.pipe(\n\t\t\t\t/*tap(data => console.log(JSON.stringify(data))),*/\n\t\t\t\tcatchError(this.handleError)\n\t\t\t);\n\t}\n}\n","import {createAction, props} from '@ngrx/store';\nimport {Gallery} from '../gallery.model';\n\nexport const loadGalleryAction = createAction('[Gallery] Load gallery', props<{id: number}>());\n\nexport const galleryLoadedAction = createAction('[Gallery] Gallery loaded', props<{gallery: Gallery}>());\n\nexport const setHomePageAction = createAction('[Gallery] Set home page');\n","import {Injectable} from '@angular/core';\nimport {GalleryService} from '../gallery.service';\nimport {Actions, createEffect, ofType} from '@ngrx/effects';\nimport * as GalleryActions from './gallery.action';\nimport {map, mergeMap} from 'rxjs/operators';\n\n@Injectable()\nexport class GalleryEffect {\n\tconstructor(private actions$:Actions, private galleryService: GalleryService) {\n\t}\n\n\tloadGalleryInfo$ = createEffect(() => {\n\t\treturn this.actions$.pipe(\n\t\t\tofType(GalleryActions.loadGalleryAction),\n\t\t\tmergeMap((data: {id: number}) => {\n\t\t\t\treturn this.galleryService.getGallery(data.id).pipe(\n\t\t\t\t\tmap(gallery => {\n\t\t\t\t\t\treturn GalleryActions.galleryLoadedAction({gallery: gallery})\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t})\n\t\t)\n\t})\n}\n","import {createReducer, on} from '@ngrx/store';\nimport * as actions from './gallery.action';\nimport {Gallery} from '../gallery.model';\n\nexport interface GalleryState {\n\tgallery: Gallery\n}\n\nconst initialState = {\n\tgallery: {\n\t\tid: 0,\n\t\tname: '',\n\t\tthumbId: 0,\n\t\tparentId: 0,\n\t\tparentGalleryId: 0,\n\t\ttagIdList: [],\n\t\tdescription: '',\n\t\tuseTags: true,\n\t\tcombinedView: false,\n\t}\n};\n\nexport const galleryReducer = createReducer<GalleryState>(\n\tinitialState,\n\ton(actions.galleryLoadedAction, (state: GalleryState, data) => {\n\t\tvar val = {\n\t\t\tgallery: {...state.gallery}\n\t\t};\n\t\tval.gallery = {...data.gallery};\n\t\treturn val;\n\t}),\n\ton(actions.setHomePageAction, (state: GalleryState) => {\n\t\tvar val = {\n\t\t\tgallery: {...state.gallery}\n\t\t};\n\t\tval.gallery.id = 0;\n\n\t\treturn val;\n\t})\n);\n","import {createFeatureSelector, createSelector} from '@ngrx/store';\nimport {GalleryState} from './gallery.reducer';\n\nconst getGalleryFeatureSelector = createFeatureSelector<GalleryState>('gallery');\n\nexport interface GalleryInfoData {\n\tname: string,\n\tdescription: string\n}\nconst EmptyGalleryInfo = {\n\tname: '',\n\tdescription: ''\n};\nexport const getGalleryInfo = createSelector(\n\tgetGalleryFeatureSelector,\n\t(state) => {\n\t\tlet data: GalleryInfoData = EmptyGalleryInfo;\n\t\tdata.name = state.gallery.name;\n\t\tdata.description = state.gallery.description;\n\t\treturn data;\n\t}\n);\n\nexport const getGalleryId = createSelector(\n\tgetGalleryFeatureSelector,\n\t(state) => {\n\t\treturn state.gallery.id;\n\t}\n);\n","import {Component, OnDestroy} from '@angular/core';\nimport {DataService} from \"../../services/data.service\";\nimport {Subscription} from \"rxjs/Subscription\";\nimport {ButtonClickService} from \"../../services/button-click.service\";\nimport {Router} from \"@angular/router\";\n\ndeclare var $: any;\n\n@Component({\n  selector: 'home-toolbar',\n  templateUrl: './home-toolbar.component.html',\n  styleUrls: ['./home-toolbar.component.css']\n})\nexport class HomeToolbarComponent implements OnDestroy {\n\n\tgallery = {\n\t\tid: 0,\n\t\tparent_id: 0,\n\t\tname: '',\n\t\tdescription: '',\n\t\ttag_list: [],\n\t\tparent_gallery: {\n\t\t\tid: 0,\n\t\t\tname: 'Homepage'\n\t\t}\n\t};\n\tobserver: Subscription;\n\n\tconstructor(private dataService: DataService,\n\t            private buttonClickService: ButtonClickService,\n\t            private router: Router) {\n\t\tthis.observer = dataService.getGalleryObserver().subscribe(\n\t\t\tdata => {\n\t\t\t\tthis.gallery = data;\n\t\t\t}\n\t\t);\n\t}\n\n\tonAddGalleryClick() {\n\t\tthis.buttonClickService.trigger('galleryAddClick');\n\t}\n\n\tngOnDestroy() {\n\t\tthis.observer.unsubscribe();\n\t}\n}\n","<gallery-edit [gallery]=\"gallery\"></gallery-edit>\n\n<div class=\"row\">\n\t<div class=\"pull-right\">\n\t\t<div class=\"btn-group\" role=\"group\" aria-label=\"...\">\n\t\t\t<button type=\"button\" (click)=\"onAddGalleryClick()\" class=\"btn btn-default\" id=\"galleryAdd\" title=\"Add gallery\" data-toggle=\"tooltip\"><span class=\"glyphicon glyphicon-th\"></span></button>\n\t\t</div>\n\t</div>\n</div>","<div class=\"modal fade\" id=\"add-modal\">\n\t<div class=\"modal-dialog\">\n\t\t<div class=\"modal-content\">\n\t\t\t<div class=\"modal-header\">\n\t\t\t\t<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n\t\t\t\t<h4 class=\"modal-title\">Add image</h4>\n\t\t\t</div>\n\t\t\t<form action=\"\" method=\"post\" class=\"form-horizontal\">\n\t\t\t\t<div class=\"modal-body\">\n\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<label for=\"inputImageDescription\" class=\"col-sm-2 control-label\">Description</label>\n\t\t\t\t\t\t<div class=\"col-sm-10\">\n\t\t\t\t\t\t\t<textarea class=\"form-control\" name=\"inputImageDescription\" id=\"inputImageDescription\" placeholder=\"Edit...\" [(ngModel)]=\"description\"></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<label for=\"inputImageTags\" class=\"col-sm-2 control-label\">Tags</label>\n\t\t\t\t\t\t<div class=\"col-sm-10\">\n\t\t\t\t\t\t\t<select class=\"form-control\" name=\"inputImageTags[]\" id=\"inputImageTags\" style=\"width: 100%\" multiple>\n\t\t\t\t\t\t\t\t<option *ngFor=\"let tag of tagList\" value=\"{{tag.id}}\" selected=\"selected\">{{tag.name}}</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<label for=\"inputImageTags\" class=\"col-sm-2 control-label\">Image</label>\n\t\t\t\t\t\t<div class=\"col-sm-10\">\n\t\t\t\t\t\t\t<p-fileUpload url=\"/api/upload\" name=\"myfile[]\" accept=\"image/*\" auto=\"auto\" (onUpload)=\"onUpload($event)\" multiple=\"multiple\">\n\t\t\t\t\t\t\t\t<ng-template pTemplate=\"content\">\n\t\t\t\t\t\t\t\t\t<ul *ngIf=\"uploadedFiles.length\" class=\"list-unstyled uploaded-image-list\">\n\t\t\t\t\t\t\t\t\t\t<li *ngFor=\"let file of uploadedFiles\">\n\t\t\t\t\t\t\t\t\t\t\t<img width=\"50\" src=\"/image/uploaded/{{file.hash}}\">\n\t\t\t\t\t\t\t\t\t\t\t{{file.name}} - {{file.size}} bytes\n\t\t\t\t\t\t\t\t\t\t\t<a href=\"#\" (click)=\"fileDelete($event, file)\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"glyphicon glyphicon-trash\"></span>\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t</ng-template>\n\t\t\t\t\t\t\t</p-fileUpload>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"modal-footer\">\n\t\t\t\t\t<button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>\n\t\t\t\t\t<input (click)=\"onSubmit()\" type=\"submit\" class=\"btn btn-primary\" value=\"Save changes\">\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div><!-- /.modal-content -->\n\t</div><!-- /.modal-dialog -->\n</div><!-- /.modal -->\n","import {Component, Input, OnInit} from '@angular/core';\nimport {ButtonClickService} from \"../../services/button-click.service\";\nimport {Subscription} from \"rxjs/Subscription\";\nimport {Router} from \"@angular/router\";\nimport {ImageService} from \"../image.service\";\n\ndeclare var $: any;\n\n@Component({\n  selector: 'image-add',\n  templateUrl: './image-add.component.html',\n  styleUrls: ['./image-add.component.css']\n})\nexport class ImageAddComponent implements OnInit {\n\n\tprivate subscription: Subscription;\n\n\t@Input() gallery;\n\n\tfile;\n\tfilename: String = '';\n\tdescription: String = '';\n\ttagList = [];\n\n\tuploadedFiles: any[] = [];\n\n\tconstructor(private buttonClickService: ButtonClickService,\n\t            private imageService: ImageService,\n\t            private router: Router) {\n\t\tthis.subscription = this.buttonClickService.notifyObservable$.subscribe(\n\t\t\tdata => {\n\t\t\t\tif (data.name !== 'imageAddClick')\n\t\t\t\t\treturn;\n\n\t\t\t\tthis.reset();\n\t\t\t\t$('#add-modal').modal('show');\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t$('#inputImageTags').select2({\n\t\t\t\t\t\ttags: true,\n\t\t\t\t\t\tajax: {\n\t\t\t\t\t\t\turl: '/api/tag_lookup',\n\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\tdata: function (params) {\n\t\t\t\t\t\t\t\treturn  {\n\t\t\t\t\t\t\t\t\tq: params.term,\n\t\t\t\t\t\t\t\t\tpage: params.page || 1\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t)\n\t}\n\n\treset() {\n\t\tthis.description = '';\n\t\tthis.tagList = [];\n\n\t\tfor (let tag of this.gallery.tag_list) {\n\t\t\tthis.tagList.push({name: tag.name, id: ''+tag.id});\n\t\t}\n\t}\n\n\tonSubmit() {\n\t\t// Select2 isn't synchronising so we have to get the selections manually\n\t\tlet tagData = $('#inputImageTags').select2('data');\n\t\tlet tags = [];\n\t\tfor (let tag of tagData)\n\t\t{\n\t\t\ttags.push(tag.id);\n\t\t}\n\n\t\tlet files = this.uploadedFiles.map((file) => {\n\t\t\treturn file.hash\n\t\t});\n\n\t\t/*this.imageService.SubmitImages({\n\t\t\tid: 0,\n\t\t\tgallery_id: this.gallery.id,\n\t\t\tdescription: this.description,\n\t\t\ttags: tags,\n\t\t\tfileHashes: files\n\t\t}).subscribe(data => {\n\t\t\tlet options =\n\t\t\t\t{\n\t\t\t\t\tmessage: 'Image saved',\n\t\t\t\t\tcontainer: '#editSuccessContainer',\n\t\t\t\t\tduration: 5000\n\t\t\t\t};\n\t\t\t$.meow(options);\n\t\t\t$('#inputImageTags').children().remove();\n\t\t\t$('#add-modal').modal('hide');\n\n\t\t\tif (files.length === 1)\n\t\t\t\tthis.router.navigate(['/image/' + this.gallery.id + '/' + data.message]);\n\t\t});*/\n\t}\n\n\tngOnInit() {\n\t}\n\n\tonUpload(event) {\n\t\tlet response = JSON.parse(event.xhr.response);\n\n\t\tfor (let file of event.files) {\n\t\t\tlet hash = '';\n\n\t\t\tfor (let r of response) {\n\t\t\t\tif (r.filename === file.name)\n\t\t\t\t\thash = r.hash;\n\t\t\t}\n\n\t\t\tfile.hash = hash;\n\t\t\tthis.uploadedFiles.push(file);\n\t\t}\n\t}\n\n\tfileDelete($event, file) {\n\t\t$event.preventDefault();\n\t\tconsole.log(file);\n\t\tlet fileIndex = -1;\n\t\tfor (let {item, index} of this.uploadedFiles.map((item, index) => ({ item, index })))\n\t\t{\n\t\t\tif (item.hash === file.hash)\n\t\t\t\tfileIndex = index;\n\t\t}\n\n\t\tif (fileIndex > -1)\n\t\t\tthis.uploadedFiles.splice(fileIndex, 1);\n\t}\n}\n","<div class=\"modal fade\" id=\"edit-modal\">\n\t<div class=\"modal-dialog\">\n\t\t<div class=\"modal-content\">\n\t\t\t<div class=\"modal-header\">\n\t\t\t\t<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n\t\t\t\t<h4 class=\"modal-title\">Edit image</h4>\n\t\t\t</div>\n\t\t\t<form action=\"\" method=\"post\" class=\"form-horizontal\">\n\t\t\t\t<div class=\"modal-body\">\n\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<label for=\"inputImageDescription\" class=\"col-sm-2 control-label\">Description</label>\n\t\t\t\t\t\t<div class=\"col-sm-10\">\n\t\t\t\t\t\t\t<textarea class=\"form-control\" name=\"inputImageDescription\" id=\"inputImageDescription\" placeholder=\"Edit...\" [(ngModel)]=\"description\"></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t<label for=\"inputImageTags\" class=\"col-sm-2 control-label\">Tags</label>\n\t\t\t\t\t\t<div class=\"col-sm-10\">\n\t\t\t\t\t\t\t<select class=\"form-control\" name=\"inputImageTags[]\" id=\"inputImageTags\" style=\"width: 100%\" multiple>\n\t\t\t\t\t\t\t\t<option *ngFor=\"let tag of tagList\" value=\"{{tag.id}}\" selected=\"selected\">{{tag.name}}</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"modal-footer\">\n\t\t\t\t\t<button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>\n\t\t\t\t\t<input (click)=\"onSubmit()\" type=\"submit\" class=\"btn btn-primary\" value=\"Save changes\">\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div><!-- /.modal-content -->\n\t</div><!-- /.modal-dialog -->\n</div><!-- /.modal -->\n","import {Component, Input, OnInit} from '@angular/core';\nimport {ButtonClickService} from \"../../services/button-click.service\";\nimport {Subscription} from \"rxjs/Subscription\";\nimport {Router} from \"@angular/router\";\nimport {ImageService} from \"../image.service\";\n\ndeclare var $: any;\n\n@Component({\n  selector: 'image-edit',\n  templateUrl: './image-edit.component.html',\n  styleUrls: ['./image-edit.component.css']\n})\nexport class ImageEditComponent implements OnInit {\n\n\tprivate subscription: Subscription;\n\n\t@Input() image;\n\n\tid: String = '0';\n\ttagList = [];\n\tdescription: String = '';\n\n\tconstructor(private buttonClickService: ButtonClickService,\n\t            private imageService: ImageService,\n\t            private router: Router) {\n\t\tthis.subscription = this.buttonClickService.notifyObservable$.subscribe(\n\t\t\tdata => {\n\t\t\t\tif (data.name !== 'imageEditClick')\n\t\t\t\t\treturn;\n\n\t\t\t\tthis.reset();\n\t\t\t\t$('#edit-modal').modal('show');\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t$('#inputImageTags').select2({\n\t\t\t\t\t\ttags: true,\n\t\t\t\t\t\tajax: {\n\t\t\t\t\t\t\turl: '/api/tag_lookup',\n\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\tdata: function (params) {\n\t\t\t\t\t\t\t\treturn  {\n\t\t\t\t\t\t\t\t\tq: params.term,\n\t\t\t\t\t\t\t\t\tpage: params.page || 1\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t)\n\t}\n\n\treset() {\n\t\tthis.id = ''+this.image.id;\n\t\tthis.description = this.image.description;\n\t\tthis.tagList = [];\n\n\t\tlet tags = [];\n\t\tfor (let tag of this.image.tag_list) {\n\t\t\tthis.tagList.push({name: tag.name, id: ''+tag.id});\n\t\t\ttags.push(''+tag.id);\n\t\t}\n\t\t$('#inputImageTags').val(tags);\n\t}\n\n\tonSubmit() {\n\t\t// Select2 isn't synchronising so we have to get the selections manually\n\t\tlet tagData = $('#inputImageTags').select2('data');\n\t\tlet tags = [];\n\t\tfor (let tag of tagData)\n\t\t{\n\t\t\ttags.push(tag.id);\n\t\t}\n\n\t\t/*this.imageService.SubmitImages({\n\t\t\tid: this.image.id,\n\t\t\tgallery_id: this.image.gallery_id,\n\t\t\tdescription: this.description,\n\t\t\ttags: tags,\n\t\t}).subscribe(data => {\n\t\t\tlet options =\n\t\t\t\t{\n\t\t\t\t\tmessage: 'Image saved',\n\t\t\t\t\tcontainer: '#editSuccessContainer',\n\t\t\t\t\tduration: 5000\n\t\t\t\t};\n\t\t\t$.meow(options);\n\t\t\t$('#inputImageTags').children().remove();\n\t\t\t$('#edit-modal').modal('hide');\n\t\t});*/\n\t}\n\n\tngOnInit() {\n\t}\n\n}\n","import { Component, OnDestroy } from '@angular/core';\nimport {DataService} from \"../../services/data.service\";\nimport {Subscription} from \"rxjs/Subscription\";\n\n@Component({\n  selector: 'image-info',\n  templateUrl: './image-info.component.html',\n  styleUrls: ['./image-info.component.css']\n})\nexport class ImageInfoComponent implements OnDestroy {\n\n\timage = {\n\t\tid: 0,\n\t\timage_src: '',\n\t\tdescription: '',\n\t\tformat: 'jpg',\n\t\tfilename: ''\n\t};\n\tobserver: Subscription;\n\timageFullUrl: string;\n\n\tconstructor(private service: DataService) {\n\t\tthis.imageFullUrl = this.getFullImageUrl();\n\t\tthis.observer = service.getImageObserver().subscribe(\n\t\t\tdata => {\n\t\t\t\tthis.image = data;\n\t\t\t\tthis.imageFullUrl = this.getFullImageUrl();\n\t\t\t}\n\t\t);\n\t}\n\n\tngOnDestroy() {\n\t\tthis.observer.unsubscribe();\n\t}\n\n\tgetFullImageUrl() {\n\t\treturn '/image/' + this.image.id + '/' + this.image.filename;\n\t}\n}\n","<div class=\"moa-page\">\n\t<p>\n\t\t{{image.description}}\n\t</p>\n\t<div class=\"image-container\">\n\t\t<a [href]=\"getFullImageUrl()\" ng-box [title]=\"image.filename\" class=\"image-lightbox-link\">\n\t\t\t<img src=\"{{image.image_src}}\">\n\t\t</a>\n\t</div>\n\t<br>\n\t<div class=\"row\">\n\t\t<a [href]=\"getFullImageUrl()\" target=\"_blank\" class=\"btn btn-info col-md-2 col-md-offset-5\">\n\t\t\t<span class=\"glyphicon glyphicon-new-window pull-left\"></span> Open in new tab\n\t\t</a>\n\t</div>\n</div>\n<ngbox></ngbox>","<ul class=\"list-unstyled\">\n\t<li *ngFor=\"let image of images\" class=\"thumbnail\">\n\t\t<image-thumb [image]=\"image\" [gallery_id]=\"gallery.id\">\n\t\t</image-thumb>\n\t</li>\n</ul>\n","import {Component, OnInit, OnDestroy} from '@angular/core';\nimport {Subscription} from \"rxjs/Subscription\";\nimport {DataService} from \"../../services/data.service\";\nimport {ThumbnailService} from \"../../services/thumbnail.service\";\n\n@Component({\n  selector: 'image-list',\n  templateUrl: './image-list.component.html',\n  styleUrls: ['./image-list.component.css']\n})\nexport class ImageListComponent implements OnInit, OnDestroy {\n\n\tstatic readonly TARGET_HEIGHT: Number = 300;\n\tstatic readonly GALLERY_WIDTH: Number = 1140;\n\n\timages: Array<any>;\n\tgallery: Array<any>;\n\timagesObserver: Subscription;\n\tgalleryObserver: Subscription;\n\tthumbSub: Subscription;\n\n\tconstructor(private service: DataService,\n\t            private thumbService: ThumbnailService) {\n\t\tthis.imagesObserver = service.getImagesObserver().subscribe(\n\t\t\tdata => {\n\t\t\t\tthis.images = data;\n\t\t\t\tthis.checkThumbs();\n\t\t\t}\n\t\t);\n\n\t\tthis.galleryObserver = service.getGalleryObserver().subscribe(\n\t\t\tdata => {\n\t\t\t\tthis.gallery = data;\n\t\t\t}\n\t\t);\n\t}\n\n\tngOnInit() {\n\t\tthis.checkThumbs();\n\t}\n\n\tprivate checkThumbs() {\n\t\tlet imageWidths = [];\n\t\tlet totalWidth = 0;\n\n\t\tif (this.thumbSub !== undefined)\n\t\t\tthis.thumbSub.unsubscribe();\n\n\t\tlet toGenerate = [];\n\t\tif (this.images !== undefined) {\n\t\t\tfor (let image of this.images) {\n\t\t\t\tif (image.isGenerating) {\n\t\t\t\t\ttoGenerate.push(parseInt(image.id));\n\t\t\t\t}\n\n\t\t\t\tlet width = image.width * (Number(ImageListComponent.TARGET_HEIGHT) / image.height);\n\t\t\t\timageWidths.push(width);\n\t\t\t\ttotalWidth += width;\n\t\t\t}\n\n\t\t\tif (toGenerate.length > 0)\n\t\t\t\tthis.getThumbs(toGenerate);\n\n\t\t\tlet maxWidth = Number(ImageListComponent.GALLERY_WIDTH) * 1.2;\n\n\t\t\tlet rows = [];\n\t\t\tlet row = {\n\t\t\t\twidth: 0,\n\t\t\t\timages: 0\n\t\t\t};\n\t\t\tlet i = 0;\n\t\t\twhile (i < imageWidths.length) {\n\t\t\t\trow.width += imageWidths[i];\n\t\t\t\trow.images++;\n\t\t\t\tif ((row.width > ImageListComponent.GALLERY_WIDTH) &&\n\t\t\t\t\t(row.images > 1)) {\n\t\t\t\t\tif (row.width > maxWidth) {\n\t\t\t\t\t\trow.width -= imageWidths[i];\n\t\t\t\t\t\trow.images--;\n\t\t\t\t\t\trows.push(row);\n\t\t\t\t\t\trow = {\n\t\t\t\t\t\t\twidth: imageWidths[i],\n\t\t\t\t\t\t\timages: 1\n\t\t\t\t\t\t};\n\t\t\t\t\t} else {\n\t\t\t\t\t\trows.push(row);\n\t\t\t\t\t\trow = {\n\t\t\t\t\t\t\twidth: 0,\n\t\t\t\t\t\t\timages: 0\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t\t}\n\t\t\tif ((row.images === 1) &&\n\t\t\t\t(rows.length > 0)){\n\t\t\t\trows[rows.length-1].images++;\n\t\t\t\trows[rows.length-1].width += row.width;\n\t\t\t\trow = {\n\t\t\t\t\twidth: 0,\n\t\t\t\t\timages: 0\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ((row.images > 1) ||\n\t\t\t\t(rows.length === 0)) {\n\t\t\t\trows.push(row);\n\t\t\t}\n\n\t\t\ti = 0;\n\t\t\tfor (let row of rows) {\n\t\t\t\tlet scaleFactor = Number(ImageListComponent.GALLERY_WIDTH) / row.width;\n\t\t\t\tfor (let j = 0; j < row.images; j++) {\n\t\t\t\t\tthis.images[i].displayWidth = Math.floor(imageWidths[i] * scaleFactor);\n\t\t\t\t\tthis.images[i].displayHeight = Math.floor   (Number(ImageListComponent.TARGET_HEIGHT) * scaleFactor);\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getThumbs(toGenerate: Array<number>) {\n\t\tthis.thumbSub = this.thumbService.getStatus(toGenerate).subscribe(data => {\n\t\t\tlet nextBatch = [];\n\t\t\tfor (let image of toGenerate) {\n\t\t\t\tlet found: boolean = false;\n\t\t\t\tfor (let notDoneYet of data) {\n\t\t\t\t\tif (image == notDoneYet)\n\t\t\t\t\t\tfound = true;\n\t\t\t\t}\n\n\t\t\t\tif (!found) {\n\t\t\t\t\tfor (let i of this.images) {\n\t\t\t\t\t\tif (image == i.id)\n\t\t\t\t\t\t\ti.isGenerating = false;\n\t\t\t\t\t}\n\t\t\t\t} else\n\t\t\t\t{\n\t\t\t\t\tnextBatch.push(image);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.thumbSub.unsubscribe();\n\n\t\t\tif (nextBatch.length > 0) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.getThumbs(nextBatch);\n\t\t\t\t}, 200);\n\t\t\t}\n\t\t});\n\t}\n\n\tngOnDestroy() {\n\t\tthis.imagesObserver.unsubscribe();\n\t\tthis.galleryObserver.unsubscribe();\n\t}\n}\n","<div>\n\t<a [routerLink]=\"[getLink()]\">\n\t\t<img *ngIf=\"!image.isGenerating && image.displayWidth <= 450 && image.displayHeight <= 300\" src=\"/image/thumb/{{image.id}}.jpg\" [ngStyle]=\"{width: (image.displayWidth - 10) + 'px', height: image.displayHeight + 'px'}\">\n\t\t<img *ngIf=\"!image.isGenerating && (image.displayWidth > 450 || image.displayHeight > 300)\" src=\"/image/thumb/{{image.id}}-w.jpg\" [ngStyle]=\"{width: (image.displayWidth - 10) + 'px', height: image.displayHeight + 'px'}\">\n\t\t<img *ngIf=\"image.isGenerating\" src=\"/media/spinner.svg\" class=\"thumbnail-generating\">\n\t\t<span>{{image.filename}}</span>\n\t</a>\n</div>\n","import {Component, Input} from '@angular/core';\n\n@Component({\n  selector: 'image-thumb',\n  templateUrl: './image-thumb.component.html',\n  styleUrls: ['./image-thumb.component.css']\n})\nexport class ImageThumbComponent {\n\n\t@Input() image: any;\n\t@Input() gallery_id: any;\n\n\tconstructor() { }\n\tgetLink() {\n\t\treturn '/image/' + this.gallery_id + '/' + this.image.id;\n\t}\n\n}\n","import { Component, OnDestroy } from '@angular/core';\nimport {ButtonClickService} from \"../../services/button-click.service\";\nimport {DataService} from \"../../services/data.service\";\nimport {Subscription} from \"rxjs/Subscription\";\nimport {Router} from \"@angular/router\";\nimport {ImageService} from \"../image.service\";\n\ndeclare var $: any;\n\n@Component({\n  selector: 'image-toolbar',\n  templateUrl: './image-toolbar.component.html',\n  styleUrls: ['./image-toolbar.component.css']\n})\nexport class ImageToolbarComponent implements OnDestroy {\n\n\timage = {\n\t\tid: 0,\n\t\tname: '',\n\t\tdescription: '',\n\t\tgallery_id: 0\n\t};\n\tobserver: Subscription;\n\n\tconstructor(private dataService: DataService,\n\t\t\t\tprivate buttonClickService: ButtonClickService,\n\t\t\t\tprivate imageService: ImageService,\n\t            private router: Router) {\n\t\tthis.observer = dataService.getImageObserver().subscribe(\n\t\t\tdata => {\n\t\t\t\tthis.image = data;\n\t\t\t}\n\t\t);\n\t}\n\n\tonEditClick() {\n\t\tthis.buttonClickService.trigger('imageEditClick');\n\t}\n\n\tonDeleteClick() {\n\t\tif (confirm('Delete this image?')) {\n\t\t\t/*this.imageService.DeleteImage(this.image.id).subscribe(next => {\n\t\t\t\tlet options =\n\t\t\t\t\t{\n\t\t\t\t\t\tmessage: 'Image deleted',\n\t\t\t\t\t\tcontainer: '#editSuccessContainer',\n\t\t\t\t\t\tduration: 5000\n\t\t\t\t\t};\n\t\t\t\t$.meow(options);\n\n\t\t\t\tthis.router.navigate(['/gallery/' + this.image.gallery_id]);\n\t\t\t});*/\n\t\t}\n\t}\n\n\tngOnDestroy() {\n\t\tthis.observer.unsubscribe();\n\t}\n}\n","<image-edit [image]=\"image\"></image-edit>\n\n<div class=\"row\">\n\t<div class=\"pull-right\">\n\t\t<div class=\"btn-group\" role=\"group\" aria-label=\"...\">\n\t\t\t<button type=\"button\" (click)=\"onEditClick()\" class=\"btn btn-default\" id=\"imageEdit\" title=\"Edit image\" data-toggle=\"tooltip\"><span class=\"glyphicon glyphicon-pencil\"></span></button>\n\t\t\t<button type=\"button\" (click)=\"onDeleteClick()\" class=\"btn btn-default\" id=\"imageDelete\" title=\"Delete image\" data-toggle=\"tooltip\"><span class=\"glyphicon glyphicon-trash\"></span></button>\n\t\t</div>\n\t</div>\n</div>","import {Injectable} from \"@angular/core\";\nimport {HttpClient} from \"@angular/common/http\";\n\n@Injectable()\nexport class ImageService {\n\n\tprotected api_url: string = '/api/image/';\n\n\tconstructor(private http: HttpClient) {\n\t}\n}\n","import { Component, Input, Output, EventEmitter, ViewChild, ElementRef, HostListener, DoCheck } from '@angular/core';\nimport { NgBoxService } from './ngbox.service';\n\n\n@Component({\n    selector: 'my-ngbox, ngbox',\n    template: `\n        <div id=\"ngBoxLoading\" *ngIf=\"ngBox.loading\"><img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNv\nZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cD\novL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjAiIHdpZHRo\nPSIxNjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMTI4IDE2IiB4bWw6c3BhY2U9InByZXNlcnZlIj48c2NyaXB0IHR5cGU9InRleHQvZW\nNtYXNjcmlwdCIgeGxpbms6aHJlZj0iLy9wcmVsb2FkZXJzLm5ldC9qc2NyaXB0cy9zbWlsLnVzZXIuanMiLz48cGF0aCBmaWxsPSIjZmZmZmZmIiBm\naWxsLW9wYWNpdHk9IjAuNDE5NjA3ODQzMTM3MjUiIGQ9Ik02LjQsNC44QTMuMiwzLjIsMCwxLDEsMy4yLDgsMy4yLDMuMiwwLDAsMSw2LjQsNC44Wm\n0xMi44LDBBMy4yLDMuMiwwLDEsMSwxNiw4LDMuMiwzLjIsMCwwLDEsMTkuMiw0LjhaTTMyLDQuOEEzLjIsMy4yLDAsMSwxLDI4LjgsOCwzLjIsMy4y\nLDAsMCwxLDMyLDQuOFptMTIuOCwwQTMuMiwzLjIsMCwxLDEsNDEuNiw4LDMuMiwzLjIsMCwwLDEsNDQuOCw0LjhabTEyLjgsMEEzLjIsMy4yLDAsMS\nwxLDU0LjQsOCwzLjIsMy4yLDAsMCwxLDU3LjYsNC44Wm0xMi44LDBBMy4yLDMuMiwwLDEsMSw2Ny4yLDgsMy4yLDMuMiwwLDAsMSw3MC40LDQuOFpt\nMTIuOCwwQTMuMiwzLjIsMCwxLDEsODAsOCwzLjIsMy4yLDAsMCwxLDgzLjIsNC44Wk05Niw0LjhBMy4yLDMuMiwwLDEsMSw5Mi44LDgsMy4yLDMuMi\nwwLDAsMSw5Niw0LjhabTEyLjgsMEEzLjIsMy4yLDAsMSwxLDEwNS42LDgsMy4yLDMuMiwwLDAsMSwxMDguOCw0LjhabTEyLjgsMEEzLjIsMy4yLDAs\nMSwxLDExOC40LDgsMy4yLDMuMiwwLDAsMSwxMjEuNiw0LjhaIi8+PGc+PHBhdGggZmlsbD0iI2ZmZmZmZiIgZmlsbC1vcGFjaXR5PSIxIiBkPSJNLT\nQyLjcsMy44NEE0LjE2LDQuMTYsMCwwLDEtMzguNTQsOGE0LjE2LDQuMTYsMCwwLDEtNC4xNiw0LjE2QTQuMTYsNC4xNiwwLDAsMS00Ni44Niw4LDQu\nMTYsNC4xNiwwLDAsMS00Mi43LDMuODRabTEyLjgtLjY0QTQuOCw0LjgsMCwwLDEtMjUuMSw4YTQuOCw0LjgsMCwwLDEtNC44LDQuOEE0LjgsNC44LD\nAsMCwxLTM0LjcsOCw0LjgsNC44LDAsMCwxLTI5LjksMy4yWm0xMi44LS42NEE1LjQ0LDUuNDQsMCwwLDEtMTEuNjYsOGE1LjQ0LDUuNDQsMCwwLDEt\nNS40NCw1LjQ0QTUuNDQsNS40NCwwLDAsMS0yMi41NCw4LDUuNDQsNS40NCwwLDAsMS0xNy4xLDIuNTZaIi8+PGFuaW1hdGVUcmFuc2Zvcm0gYXR0cm\nlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJ0cmFuc2xhdGUiIHZhbHVlcz0iMjMgMDszNiAwOzQ5IDA7NjIgMDs3NC41IDA7ODcuNSAwOzEwMCAw\nOzExMyAwOzEyNS41IDA7MTM4LjUgMDsxNTEuNSAwOzE2NC41IDA7MTc4IDAiIGNhbGNNb2RlPSJkaXNjcmV0ZSIgZHVyPSI3ODBtcyIgcmVwZWF0Q2\n91bnQ9ImluZGVmaW5pdGUiLz48L2c+PC9zdmc+Cg==\"/></div>\n        <div id=\"ngBoxWrapper\" (click)=\"closeOutside($event)\" *ngIf=\"ngBox.open\" [ngStyle]=\"{'padding-top': offsetHeight+'px'}\">\n            <div id=\"ngBoxContent\">\n                <img *ngIf=\"getHasGroup()\" class=\"left\" (click)=\"previousNgBox()\" src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvb\nj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNS4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyB\nWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL\n0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDA\nwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iNzBweCIgaGVpZ2h0PSIxMDBwe\nCIgdmlld0JveD0iMCAwIDcwIDEwMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNzAgMTAwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxwb2x5Z29uIGZpbGw\n9IiNGRkZGRkYiIHN0cm9rZT0iIzZCNkI2QiIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludHM9IjQ1LjYsOTguNTI0IDE0LjU0NCw1MCA0NS42LDEuNDc2IDQ4L\njgwMSwzLjUyNCAxOS4wNTYsNTAgDQoJNDguODAxLDk2LjQ3NiAiLz4NCjwvc3ZnPg0K\">\n                <img *ngIf=\"getHasGroup()\" class=\"right\" (click)=\"nextNgBox()\" src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0i\nMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNS4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZX\nJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dy\nYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3\nN2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iNzBweCIgaGVpZ2h0PSIxMDBweCIg\ndmlld0JveD0iMCAwIDcwIDEwMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNzAgMTAwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxwb2x5Z29uIGZpbGw9Ii\nNGRkZGRkYiIHN0cm9rZT0iIzZCNkI2QiIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludHM9IjE3Ljc0Niw5OC41MjQgNDguODAxLDUwIDE3Ljc0NiwxLjQ3NiAx\nNC41NDUsMy41MjQgDQoJNDQuMjg5LDUwIDE0LjU0NSw5Ni40NzYgIi8+DQo8L3N2Zz4NCg==\">\n                <img *ngIf=\"ngBox.current.type == 1\"\n                     (load)=\"isLoaded()\"\n                     #ngBoxContent\n                     [src]=\"ngBox.current.url\"\n                     [hidden]=\"ngBox.loading\"\n                     (click)=\"nextNgBox()\"\n                     alt=\"\">\n                <iframe *ngIf=\"ngBox.current.type == 2\"\n                        #ngBoxContent\n                        [src]=\"ngBox.current.url\"\n                        width=\"{{ngBox.current.width}}\"\n                        height=\"{{ngBox.current.height}}\"\n                        frameborder=\"0\"\n                        allowfullscreen>\n                </iframe>\n                <iframe *ngIf=\"ngBox.current.type == 3\"\n                        [src]=\"ngBox.current.url\"\n                        #ngBoxContent\n                        width=\"{{ngBox.current.width}}\"\n                        height=\"{{ngBox.current.height}}\"\n                        frameborder=\"0\"\n                        webkitallowfullscreen\n                        mozallowfullscreen\n                        allowfullscreen>\n                </iframe>\n                <iframe *ngIf=\"ngBox.current.type == 4\"\n                        #ngBoxContent\n                        [src]=\"ngBox.current.url\"\n                        frameborder=\"0\"\n                        width=\"{{ngBox.current.width}}\"\n                        height=\"{{ngBox.current.height}}\"\n                        allowfullscreen>\n                </iframe>\n            </div>\n            <div #ngBoxButtons id=\"buttons\" [hidden]=\"ngBox.loading\">\n                <p>\n                    <span class=\"title\" *ngIf=\"ngBox.current.title\">{{ngBox.current.title}}<br/></span>\n                    <span class=\"pages\" *ngIf=\"getHasGroup()\">{{getCurrentIndex()}} of {{getCount()}}</span>\n                </p>\n                <img (click)=\"closeNgBox()\" id=\"closeButton\" src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZG\nluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxNS4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAw\nIEJ1aWxkIDApICAtLT4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy\n8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6\neGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB3aWR0aD0iMzBweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwID\nAgMzAgMzAiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDMwIDMwIiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxwb2x5Z29uIGZpbGw9IiNGRkZGRkYiIHN0cm9r\nZT0iIzZCNkI2QiIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludHM9IjI4LjUsMi44NCAyNS40NjMsMS41IDE1LDEyLjc0OSA0LjUzOSwxLjUgMS41LDIuODQgDQ\noJMTIuODExLDE1IDEuNSwyNy4xNiA0LjUzOSwyOC41IDE1LDE3LjI1MSAyNS40NjMsMjguNSAyOC41LDI3LjE2IDE3LjE4OSwxNSAiLz4NCjwvc3ZnPg0K\" alt=\"\">\n            </div>\n\n\n\n\n\n\n        </div>\n    `,\n    styles: [`\n        #ngBoxLoading{\n            text-align: center;\n            z-index: 10001;\n            width: 100%;\n            height: 100%;\n            color: white;\n            position: fixed;\n            top: 46%;\n            font-size: 20px;\n        }\n        #ngBoxWrapper {\n            background-color: rgba(0, 0, 0, 0.9);\n            position: fixed;\n            top: 0px;\n            left: 0px;\n            text-align: center;\n            z-index: 10000;\n            width: 100%;\n            height: 100%;\n        }\n\n        #ngBoxWrapper #ngBoxContent img {\n            -webkit-border-radius: 4px;\n            -moz-border-radius: 4px;\n            border-radius: 4px;\n        }\n\n        #ngBoxContent {\n            display: block;\n        }\n\n        button {\n            font-size: 12px;\n        }\n\n        iframe {\n            max-width: 100%;\n            max-height: 100%;\n        }\n        #buttons{\n            position: relative;\n            margin: 5px auto;\n            text-align: right;\n        }\n        #buttons p{\n            float: left;\n            color: white;\n            text-align: left;\n            margin: 0 50px 0 0;\n            font-size: 12px;\n            font-family: sans-serif;\n        }\n        #buttons span.title{\n            display: block;\n            height: 18px;\n            overflow: hidden;\n        }\n        #closeButton{\n            position: absolute;\n            top: 0px;\n            right: 0px;\n            cursor: pointer;\n        }\n        .left{\n            position: fixed;\n            left: -5px;\n            margin-top: -42px;\n            cursor: pointer;\n            top: 50%;\n        }\n        .right{\n            position: fixed;\n            right: -10px;\n            margin-top: -42px;\n            cursor: pointer;\n            top: 50%;\n        }\n    `]\n})\nexport class NgBoxComponent implements DoCheck {\n\n    offsetHeight: number;\n    interval: any;\n    @Input() data: any;\n    @Output() showMore = new EventEmitter();\n    @ViewChild('ngBoxContent', {}) elementView: ElementRef;\n    @ViewChild('ngBoxButtons', {}) elementButtons: ElementRef;\n\n    constructor(\n        public ngBox: NgBoxService\n    ) {\n    }\n\n    ngDoCheck() {\n        if (this.ngBox.open === true && this.elementView === undefined) {\n            this.checkInterval();\n        }\n    }\n\n    closeOutside($event) {\n        if ($event.target.getAttribute('id') === 'ngBoxContent' || $event.target.getAttribute('id') === 'ngBoxWrapper') {\n            this.closeNgBox();\n        }\n    }\n\n    checkInterval() {\n        let t = setInterval(() => {\n            if (this.elementView && this.elementButtons  ) {\n                this.resize();\n                // Stop Loading on frames\n                if (this.ngBox.current.type === 2 || this.ngBox.current.type === 3 || this.ngBox.current.type === 4) {\n                    this.ngBox.loading = false;\n                }\n\n                clearInterval(t);\n            }\n        }, 10);\n    }\n\n    closeNgBox() {\n        this.ngBox.open = false;\n    }\n\n    elementExist() {\n        if (this.elementView !== undefined) {\n            return true;\n        }\n        return false;\n    }\n\n    @HostListener('window:resize', ['$event'])\n    resize() {\n        // Resize big images\n\n        if ( this.elementView && this.elementButtons) {\n            let currentWidth = this.calcPercent(this.ngBox.current.width, window.innerWidth);\n            let currentHeight = this.calcPercent(this.ngBox.current.height, window.innerHeight);\n\n            let realWidth   = this.elementView.nativeElement.naturalWidth ?\n                              this.elementView.nativeElement.naturalWidth : currentWidth;\n            let realHeight  = this.elementView.nativeElement.naturalHeight ?\n                              this.elementView.nativeElement.naturalHeight : currentHeight;\n\n\n            let maxWidth    = Math.min((window.innerWidth - 70), currentWidth ? currentWidth : realWidth);\n            let maxHeight   = Math.min((window.innerHeight - 60), currentHeight ? currentHeight : realHeight);\n\n            let ratio       = Math.min( maxWidth / realWidth, maxHeight / realHeight);\n\n            this.elementView.nativeElement.width    = realWidth * ratio;\n            this.elementView.nativeElement.height   = realHeight * ratio;\n\n\n            this.elementButtons.nativeElement.style.width = this.elementView.nativeElement.offsetWidth + 'px';\n\n            // Calculate top padding\n            this.offsetHeight = (window.innerHeight - 40 - this.elementView.nativeElement.offsetHeight) / 2;\n            if (this.offsetHeight < 0) {\n                this.offsetHeight = 0;\n            }\n        }\n    }\n\n\n\n\n    @HostListener('window:keydown', ['$event'])\n    checkKeyPress(event: KeyboardEvent) {\n        if ( event.keyCode === 39 ) {\n            this.nextNgBox();\n        }else if ( event.keyCode === 37 ) {\n            this.previousNgBox();\n        }else if ( event.keyCode === 27 ) {\n            this.closeNgBox();\n        }\n    }\n\n    calcPercent(value, of) {\n        if (value !== undefined && value.toString().search('%') >= 0) {\n            return of * parseInt(value.toString(), 0) / 100;\n        }\n        return value;\n    }\n\n    getHasGroup() {\n        return this.ngBox.current.group !== undefined;\n    }\n\n    getCount() {\n        return this.ngBox.images.filter(image => image.group === this.ngBox.current.group).length;\n    }\n\n    getCurrentIndex() {\n        let currentGroup = this.ngBox.images.filter(image => image.group === this.ngBox.current.group);\n        return currentGroup.map(function (e) {\n            return e.id;\n        }).indexOf(this.ngBox.current.id) + 1;\n    }\n\n    nextNgBox() {\n        if ( this.ngBox.current.group === undefined ) {\n            return false;\n        }\n        this.ngBox.loading = true;\n        let currentGroup = this.ngBox.images.filter(image => image.group === this.ngBox.current.group);\n        let pos = currentGroup.map(function (e) {\n            return e.id;\n        }).indexOf(this.ngBox.current.id);\n        if (pos >= currentGroup.length - 1) {\n            this.ngBox.current = currentGroup[0];\n        } else {\n            this.ngBox.current = currentGroup[pos + 1];\n        }\n        this.checkInterval();\n    }\n\n    previousNgBox() {\n        if ( this.ngBox.current.group === undefined ) {\n            return false;\n        }\n        this.ngBox.loading = true;\n        let currentGroup = this.ngBox.images.filter(image => image.group === this.ngBox.current.group);\n        let pos = currentGroup.map(function (e) {\n            return e.id;\n        }).indexOf(this.ngBox.current.id);\n        if (pos === 0) {\n            pos = currentGroup.length;\n        }\n        this.ngBox.current = currentGroup[pos - 1];\n        this.checkInterval();\n    }\n\n    isLoaded() {\n        if (this.ngBox.current.type === 1) {\n            this.ngBox.loading = false;\n        }\n\n        this.checkInterval();\n    }\n\n}\n","import { Directive, AfterViewInit, HostListener, Input, OnDestroy } from '@angular/core';\r\nimport { DomSanitizer, SafeResourceUrl } from '@angular/platform-browser';\r\nimport { NgBoxService } from './ngbox.service';\r\n\r\n@Directive({\r\n    selector: '[myNgBox],[ng-box]'\r\n})\r\nexport class NgBoxDirective implements AfterViewInit, OnDestroy {\r\n\r\n    id: number;\r\n    data: {};\r\n    @Input() src: any;\r\n    @Input() href: any;\r\n    @Input() title: string;\r\n    @Input() width: string;\r\n    @Input() height: string;\r\n    @Input() group: string;\r\n    @Input() cache: boolean;\r\n    @Input() image: boolean;\r\n    currentHref: string;\r\n\tcurrentSrc: string;\r\n\r\n    constructor(\r\n        public ngBox: NgBoxService,\r\n        public sanitizer: DomSanitizer\r\n    ) {\r\n    }\r\n\r\n\tngOnDestroy() {\r\n    \tthis.removeImage();\r\n\t}\r\n\r\n    ngAfterViewInit() {\r\n        this.ngBox.id = this.id = this.ngBox.id + 1;\r\n        this.updateImage();\r\n    }\r\n\r\n\tremoveImage() {\r\n\t\tlet pos = this.ngBox.images.map(function(e) { return e.id; }).indexOf(this.id);\r\n\t\tif (pos !== -1)\r\n\t\t\tthis.ngBox.images.splice(pos, 1);\r\n\t}\r\n\r\n    updateImage() {\r\n\t    let src = this.src ? this.src : this.href;\r\n\t    this.data = this.getData(src);\r\n\t    this.ngBox.images.push( this.data );\r\n    }\r\n\r\n    @HostListener('click', ['$event'])\r\n    onClick($event) {\r\n        $event.preventDefault();\r\n\r\n\t    this.removeImage();\r\n\t    this.updateImage();\r\n\r\n        this.ngBox.loading = true;\r\n        this.ngBox.current = this.data;\r\n        this.ngBox.open = true;\r\n    }\r\n\r\n    getData(url: string): SafeResourceUrl | boolean {\r\n        if (url !== undefined || url !== '') {\r\n            // Youtube\r\n            let regExp = /^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|\\&v=|\\?v=)([^#\\&\\?]*).*/;\r\n            let match = url.match(regExp);\r\n            if (match && match[2].length === 11) {\r\n                return {\r\n                    id: this.id,\r\n                    url: this.sanitizer.bypassSecurityTrustResourceUrl('https://www.youtube.com/embed/' + match[2] + '?autoplay=0'),\r\n                    type: 2,\r\n                    title: this.title,\r\n                    width: this.width ? this.width : 640,\r\n                    height: this.height ? this.height : 380,\r\n                    group: this.group\r\n                };\r\n            }\r\n            // Vimeo\r\n            regExp = /^.*(vimeo\\.com\\/)((channels\\/[A-z]+\\/)|(groups\\/[A-z]+\\/videos\\/))?([0-9]+)/;\r\n            match = url.match(regExp);\r\n            if (match && match[5].length === 8) {\r\n                return {\r\n                    id: this.id,\r\n                    url: this.sanitizer.bypassSecurityTrustResourceUrl('https://player.vimeo.com/video/' + match[5]),\r\n                    type: 3,\r\n                    title: this.title,\r\n                    width: this.width ? this.width : 640,\r\n                    height: this.height ? this.height : 380,\r\n                    group: this.group\r\n                };\r\n            }\r\n            if (!url.match(/\\.(png|jpg|jpeg|gif|JPG|PNG|JPEG|GIF)$/) && this.image !== true) {\r\n\r\n                return {\r\n                    id: this.id,\r\n                    url: this.sanitizer.bypassSecurityTrustResourceUrl(url),\r\n                    type: 4,\r\n                    title: this.title,\r\n                    width: this.width ? this.width : 1000,\r\n                    height: this.height ? this.height : 480,\r\n                    group: this.group\r\n                };\r\n            }\r\n/*            if (url.search('photoshooter') >= 0 || url.search('news247') >= 0) {\r\n                return {\r\n                    id: this.id,\r\n                    url: this.sanitizer.bypassSecurityTrustResourceUrl(url),\r\n                    type: 4,\r\n                    title: this.title,\r\n                    width: this.width ? this.width : 1000,\r\n                    height: this.height ? this.height : 480,\r\n                    group: this.group\r\n                };\r\n            }*/\r\n            if (this.cache) { (new Image()).src = url; }\r\n            return {\r\n                id: this.id,\r\n                url: url,\r\n                type: 1,\r\n                title: this.title,\r\n                width: this.width,\r\n                height: this.height,\r\n                group: this.group\r\n            };\r\n\r\n        }\r\n    }\r\n\r\n\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable()\r\nexport class NgBoxService {\r\n\r\n    public id = 0;\r\n    public current: any;\r\n    public loading = false;\r\n    public open = false;\r\n    public images: any = [];\r\n\r\n    constructor() { }\r\n\r\n}\r\n","import { Component, OnInit } from '@angular/core';\nimport {ActivatedRoute} from '@angular/router';\nimport {loadGalleryAction} from '../../gallery/state/gallery.action';\nimport {Store} from '@ngrx/store';\nimport {GalleryState} from '../../gallery/state/gallery.reducer';\nimport {State} from '../../state/app.state';\nimport {loadOtherDataAction} from '../../state/app.action';\n\n@Component({\n\tselector: 'gallery-page',\n\ttemplateUrl: './gallery-page.component.html',\n\tstyleUrls: ['./gallery-page.component.css']\n})\nexport class GalleryPageComponent implements OnInit {\n\n\tpublic id: number = 0;\n\n\tconstructor(private route: ActivatedRoute,\n\t            private galleryStore: Store<GalleryState>,\n\t            private rootStore: Store<State>) {\n\t}\n\n\tngOnInit(): void {\n\t\tthis.route.params.subscribe(params => {\n\t\t\tthis.id = params.gallery_id;\n\t\t\tthis.galleryStore.dispatch(loadGalleryAction({id: this.id}));\n\t\t\tthis.rootStore.dispatch(loadOtherDataAction());\n\t\t});\n\t}\n}\n","<gallery-info></gallery-info>\n<gallery-list></gallery-list>\n<image-list></image-list>\n","import {Component, OnInit} from '@angular/core';\nimport {ActivatedRoute} from '@angular/router';\nimport {Store} from '@ngrx/store';\nimport {GalleryState} from '../../gallery/state/gallery.reducer';\nimport {State} from '../../state/app.state';\nimport {loadOtherDataAction} from '../../state/app.action';\nimport {setHomePageAction} from '../../gallery/state/gallery.action';\n\n@Component({\n    selector: 'moa',\n    templateUrl: './home-page.component.html',\n    styleUrls: ['./home-page.component.css']\n})\nexport class HomePageComponent implements OnInit {\n\tconstructor(private route: ActivatedRoute,\n\t            private galleryStore: Store<GalleryState>,\n\t            private rootStore: Store<State>) {\n\t}\n\n\tngOnInit(): void {\n\t\tthis.route.params.subscribe(params => {\n\t\t\tthis.galleryStore.dispatch(setHomePageAction());\n\t\t\tthis.rootStore.dispatch(loadOtherDataAction());\n\t\t});\n\t}\n}\n","<home-toolbar></home-toolbar>\n\n<gallery-list></gallery-list>","import { Component, OnInit } from '@angular/core';\nimport {ActivatedRoute} from \"@angular/router\";\nimport {PageDataService} from \"../../services/page_data.service\";\n\n@Component({\n  selector: 'image-page',\n  templateUrl: './image-page.component.html',\n  styleUrls: ['./image-page.component.css']\n})\nexport class ImagePageComponent implements OnInit {\n\n  constructor(private route: ActivatedRoute,\n              private page_data_service: PageDataService) { }\n\n  ngOnInit() {\n\t  this.route.params.subscribe(params => {\n\t\t  this.page_data_service.GetImagePageData(params['image_id'], params['gallery_id']);\n\t  });\n  }\n\n}\n","<image-toolbar></image-toolbar>\n<image-info></image-info>","import {\n\tActionReducer,\n\tActionReducerMap,\n\tMetaReducer\n} from '@ngrx/store';\nimport { environment } from '../../environments/environment';\nimport {routerReducer} from '@ngrx/router-store';\nimport {AppReducer} from '../state/app.reducer';\n\nexport interface AppState {\n\n}\n\nexport const reducers: ActionReducerMap<AppState> = {\n\trouter: routerReducer,\n\tapp: AppReducer\n};\n\nexport function logger(reducer:ActionReducer<any>)\n\t: ActionReducer<any> {\n\treturn (state, action) => {\n\t\t//console.log(\"state before: \", state);\n\t\t//console.log(\"action\", action);\n\n\t\treturn reducer(state, action);\n\t}\n\n}\n\n\nexport const metaReducers: MetaReducer<AppState>[] =\n\t!environment.production ? [logger] : [];\n\n\n","import { Injectable } from '@angular/core';\nimport {Subject} from \"rxjs\";\n\n@Injectable()\nexport class ButtonClickService {\n\n\tprivate notify = new Subject<any>();\n\tnotifyObservable$ = this.notify.asObservable();\n\n\tconstructor() {}\n\n\tpublic trigger(name: string, data: any = null) {\n\t\tif (name) {\n\t\t\tthis.notify.next({\n\t\t\t\tname: name,\n\t\t\t\tdata: data\n\t\t\t});\n\t\t}\n\t}\n}\n","import {Injectable} from \"@angular/core\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {BehaviorSubject} from \"rxjs\";\nimport {Observable} from \"rxjs/\";\nimport 'rxjs/add/operator/map';\nimport 'rxjs/add/operator/filter';\n\n@Injectable()\nexport class DataService {\n    data: BehaviorSubject<any>;\n\n    constructor(private http: HttpClient) {\n        this.data = new BehaviorSubject<any>([]);\n    }\n\n    setPageData(pageData): void {\n        this.data.next(pageData);\n    }\n\n    getBreadcrumbObserver(): Observable<any> {\n        return this.data\n            .map(data => {\n                return data.breadcrumbs;\n            })\n            .filter(data => data !== undefined);\n    }\n\n    getGalleriesObserver(): Observable<any> {\n        return this.data\n            .map(data => {\n                return data.galleries;\n            })\n            .filter(data => data !== undefined);\n    }\n\n\tgetGalleryObserver(): Observable<any> {\n\t\treturn this.data\n\t\t\t.map(data => {\n\t\t\t\t// TODO: Convert to Gallery model?\n\t\t\t\treturn data.gallery;\n\t\t\t})\n\t\t\t.filter(data => data !== undefined);\n\t}\n\n\tgetImageObserver(): Observable<any> {\n\t\treturn this.data\n\t\t\t.map(data => {\n\t\t\t\t// TODO: Convert to Image model?\n\t\t\t\treturn data.image;\n\t\t\t})\n\t\t\t.filter(data => data !== undefined);\n\t}\n\n\tgetImagesObserver(): Observable<any> {\n\t\treturn this.data\n\t\t\t.map(data => {\n\t\t\t\treturn data.images;\n\t\t\t})\n\t\t\t.filter(data => data !== undefined);\n\t}\n\n\tgetPageTitleObserver(): Observable<any> {\n\t\treturn this.data\n\t\t\t.map(data => {\n\t\t\t\treturn data.page_title;\n\t\t\t})\n\t\t\t.filter(data => data !== undefined);\n\t}\n\n}\n","import {Injectable} from \"@angular/core\";\nimport {DataService} from \"./data.service\";\nimport {HttpClient} from \"@angular/common/http\";\n\n@Injectable()\nexport class PageDataService {\n\tprotected api_url: string = '/api/page_data/';\n\n    constructor(private data_service: DataService, private http: HttpClient) {\n    }\n\n    GetPageData(url: string) {\n\t    this.http.get(url).subscribe(data => {\n\t\t    this.data_service.setPageData(data);\n\t    });\n    }\n\n    GetHomePageData() {\n\t    let url = this.api_url + 'home_page';\n\t    this.GetPageData(url);\n    }\n\n\tGetImagePageData(image_id: number, gallery_id: number) {\n\t\tlet url = this.api_url + 'image_page/' + gallery_id + '/' + image_id;\n\t\tthis.GetPageData(url);\n\t}\n}\n","import {Injectable, OnDestroy} from \"@angular/core\";\nimport {Subscription} from \"rxjs\";\nimport {DataService} from \"./data.service\";\n\n@Injectable()\nexport class PageTitleService implements OnDestroy{\n\n\tobserver: Subscription;\n\n    constructor(private service: DataService) {\n\t    this.observer = service.getPageTitleObserver().subscribe(\n\t\t    data => {\n\t\t\t\tdocument.title = data;\n\t\t    }\n\t    );\n    }\n\n\tngOnDestroy(): void {\n\t\tthis.observer.unsubscribe();\n\t}\n}\n","import {EntityCollectionServiceBase, EntityCollectionServiceElementsFactory} from '@ngrx/data';\nimport {SimpleGallery} from '../models/simple_gallery';\nimport {Injectable} from '@angular/core';\n\n@Injectable()\nexport class SimpleGalleryEntityService extends EntityCollectionServiceBase<SimpleGallery> {\n\tconstructor(serviceElementsFactory: EntityCollectionServiceElementsFactory) {\n\t\tsuper('SimpleGallery', serviceElementsFactory);\n\t}\n}\n","import {Injectable} from '@angular/core';\nimport {DefaultDataService, HttpUrlGenerator} from '@ngrx/data';\nimport {SimpleGallery} from '../models/simple_gallery';\nimport {HttpClient} from '@angular/common/http';\n\n@Injectable()\nexport class SimpleGalleryDataService extends DefaultDataService<SimpleGallery> {\n\tconstructor(http: HttpClient, httpUrlGenerator: HttpUrlGenerator) {\n\t\tsuper('SimpleGallery', http, httpUrlGenerator);\n\t}\n}\n","import { Injectable } from '@angular/core';\nimport {Subject} from \"rxjs\";\nimport {HttpClient} from \"@angular/common/http\";\nimport {Observable} from \"rxjs\";\n\n@Injectable()\nexport class ThumbnailService {\n\n\tprivate api_url: string = '/api/thumbnail_status';\n\n\tconstructor(private http: HttpClient) {}\n\n\tpublic getStatus(data: Array<number> = null): Observable<any> {\n\t\tlet subject = new Subject();\n\n\t\tlet params = data.join(',');\n\t\tlet url = this.api_url + '?images=' + params;\n\n\t\tthis.http.get(url).subscribe(data => {\n\t\t\tsubject.next(data);\n\t\t});\n\n\t\treturn subject.asObservable();\n\t}\n}\n","import {createAction, props} from '@ngrx/store';\n\nexport const loadOtherDataAction = createAction('[Root] Load other data');\n\nexport const otherDataLoadedAction = createAction('[Root] Other data loaded', props<{galleries: [], tags: []}>());\n","import {Injectable} from '@angular/core';\nimport {AppService} from '../app.service';\nimport {Actions, createEffect, ofType} from '@ngrx/effects';\nimport * as AppActions from './app.action';\nimport {map, mergeMap} from 'rxjs/operators';\n\n@Injectable()\nexport class AppEffect {\n\tconstructor(private actions$:Actions, private appService: AppService) {\n\t}\n\n\tloadOtherData$ = createEffect(() => {\n\t\treturn this.actions$.pipe(\n\t\t\tofType(AppActions.loadOtherDataAction),\n\t\t\tmergeMap(() => {\n\t\t\t\treturn this.appService.getOtherData().pipe(\n\t\t\t\t\tmap((data) => {\n\t\t\t\t\t\treturn AppActions.otherDataLoadedAction({galleries: data.galleries, tags: data.tags})\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t})\n\t\t)\n\t})\n}\n","import {createReducer, on} from '@ngrx/store';\nimport {otherDataLoadedAction} from './app.action';\n\nexport interface AppState {\n\tgalleries: [],\n\ttags: []\n}\n\nconst initialState = {\n\tgalleries: [],\n\ttags: []\n};\n\nexport const AppReducer = createReducer<{galleries: any[], tags: any[]}>(\n\tinitialState,\n\ton(otherDataLoadedAction, (state: AppState, data) => {\n\t\tvar val = {\n\t\t\tgalleries: {...state.galleries},\n\t\t\ttags: {...state.tags}\n\t\t};\n\t\tval.galleries = {...data.galleries};\n\t\tval.tags = {...data.tags};\n\t\treturn val;\n\t})\n);\n","import {createSelector} from '@ngrx/store';\nimport {SimpleGallery} from '../models/simple_gallery';\n\nexport const galleriesFeature = (state) => state.app.galleries;\n\nexport const getSubGalleries = (props: {id: number}) => createSelector(\n\tgalleriesFeature,\n\t(galleries) => {\n\t\tif (galleries === undefined)\n\t\t\treturn [];\n\n\t\tlet subGalleries: SimpleGallery[] = [];\n\t\tlet k: keyof typeof galleries;\n\t\tfor (k in galleries) {\n\t\t\tlet gallery: SimpleGallery = galleries[k];\n\n\t\t\tif (gallery.parentId == props.id)\n\t\t\t\tsubGalleries.push(gallery);\n\t\t}\n\n\t\treturn subGalleries;\n\t}\n);\n","// The file contents for the current environment will overwrite these during build.\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\n// The list of which env maps to which file can be found in `.angular-cli.json`.\n\nexport const environment = {\n  production: false\n};\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.log(err));\n"],"names":["AppComponent","constructor","router","service","pageTitleService","elementRef","preload","JSON","parse","nativeElement","getAttribute","ngOnInit","setPageData","selectors","decls","vars","template","i0","BrowserModule","BreadcrumbComponent","GalleryListComponent","GalleryTileComponent","DataService","PageTitleService","PageDataService","HttpClientModule","RouterModule","GalleryPageComponent","HomePageComponent","GalleryInfoComponent","ImageListComponent","ImageThumbComponent","GalleryToolbarComponent","GalleryEditComponent","ButtonClickService","FormsModule","GalleryService","ImageService","ImagePageComponent","ImageInfoComponent","ImageToolbarComponent","ImageEditComponent","ThumbnailService","ImageAddComponent","FileUploadModule","HomeToolbarComponent","NgBoxService","NgBoxComponent","NgBoxDirective","EntityDataModule","StoreModule","EffectsModule","StoreDevtoolsModule","environment","metaReducers","reducers","StoreRouterConnectingModule","SimpleGalleryDataService","SimpleGalleryEntityService","GalleryModule","AppEffect","AppService","routes","path","component","resolve","entityMetadata","Gallery","entityDispatcherOptions","optimisticUpdate","SimpleGallery","AppModule","eds","entityDataService","simpleGalleryDataService","registerMetadataMap","registerService","bootstrap","imports","forRoot","runtimeChecks","strictStateImmutability","strictActionImmutability","strictActionSerializability","strictStateSerializability","instrument","maxAge","logOnly","production","stateKey","routerState","declarations","throwError","catchError","http","handleError","err","errorMessage","error","ErrorEvent","message","status","body","console","getOtherData","get","api_url","pipe","factory","observer","getBreadcrumbObserver","subscribe","data","crumbs","ngOnDestroy","unsubscribe","getLink","id","i","length","type","consts","buttonClickService","galleryService","subscription","notifyObservable$","name","addMode","reset","$","modal","setTimeout","select2","ajax","url","dataType","params","q","term","page","tags","gallery","description","useTags","showImages","combinedView","tagList","tag","push","onSubmit","tagData","galleryData","parentGallery","inputs","ctx","getGalleryInfo","store","select","getGalleryId","getSubGalleries","galleryStore","appStore","galleryId","galleries","doesThumbExist","thumbId","onEditClick","onAddGalleryClick","onAddImageClick","onDeleteClick","confirm","CommonModule","galleryReducer","GalleryEffect","forFeature","_gallery","getGallery","createAction","props","loadGalleryAction","galleryLoadedAction","setHomePageAction","createEffect","ofType","GalleryActions","map","mergeMap","actions$","createReducer","on","actions","initialState","parentId","parentGalleryId","tagIdList","state","val","createFeatureSelector","createSelector","getGalleryFeatureSelector","EmptyGalleryInfo","dataService","parent_id","tag_list","parent_gallery","getGalleryObserver","trigger","imageService","files","uploadedFiles","file","hash","onUpload","event","response","xhr","r","filename","fileDelete","$event","preventDefault","log","fileIndex","item","index","splice","image","image_src","format","imageFullUrl","getFullImageUrl","getImageObserver","thumbService","imagesObserver","getImagesObserver","images","checkThumbs","galleryObserver","imageWidths","totalWidth","thumbSub","undefined","toGenerate","isGenerating","parseInt","width","Number","TARGET_HEIGHT","height","getThumbs","maxWidth","GALLERY_WIDTH","rows","row","scaleFactor","j","displayWidth","Math","floor","displayHeight","getStatus","nextBatch","found","notDoneYet","gallery_id","EventEmitter","ngBox","ngDoCheck","open","elementView","checkInterval","closeOutside","target","closeNgBox","t","setInterval","elementButtons","resize","current","loading","clearInterval","elementExist","currentWidth","calcPercent","window","innerWidth","currentHeight","innerHeight","realWidth","naturalWidth","realHeight","naturalHeight","min","maxHeight","ratio","style","offsetWidth","offsetHeight","checkKeyPress","keyCode","nextNgBox","previousNgBox","value","of","toString","search","getHasGroup","group","getCount","filter","getCurrentIndex","currentGroup","e","indexOf","pos","isLoaded","viewQuery","sanitizer","removeImage","ngAfterViewInit","updateImage","src","href","getData","onClick","regExp","match","bypassSecurityTrustResourceUrl","title","cache","Image","hostBindings","loadOtherDataAction","route","rootStore","dispatch","page_data_service","GetImagePageData","routerReducer","AppReducer","app","logger","reducer","action","Subject","notify","asObservable","next","BehaviorSubject","pageData","breadcrumbs","getGalleriesObserver","getPageTitleObserver","page_title","data_service","GetPageData","GetHomePageData","image_id","document","EntityCollectionServiceBase","serviceElementsFactory","DefaultDataService","httpUrlGenerator","subject","join","otherDataLoadedAction","AppActions","appService","galleriesFeature","subGalleries","k","enableProdMode","__NgCli_bootstrap_1","bootstrapModule","catch"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}